/*
 * USB_control.c
 *
 *  Created on: Nov 16, 2025
 *      Author: Egquus
 */

#include "main.h"
#include "stdlib.h"
#include "stdbool.h"
#include "gpio.h"
#include "TSAC_control.h"
#include "Slave_control.h"

void USB_control(uint8_t *usb_data)
{
	usb_data[NUM_CELLS * 2 + 2] = 0xff;
	usb_data[NUM_CELLS * 2] = current >> 8;
	usb_data[NUM_CELLS * 2 + 1] = current;
	for(uint8_t i = 0; i < NUM_CELLS; i++)
	{
		usb_data[i] = usb_voltages[i];
		usb_data[NUM_CELLS + i] = usb_temperatures[i];
	}

	CDC_Transmit_FS(usb_data, NUM_CELLS * 2 + 2 + 1);
	//CDC_Transmit_FS(usb_data, 8);
}
